# =============================================================================
# SecCompOps Platform â€” Standalone Extraction Manifest
# =============================================================================
# Instructions for extracting this platform from the monorepo
# into an independent microservice repository.
apiVersion: gl.platform.v1
kind: ExtractionManifest
metadata:
  name: seccompops-platform-extraction
  version: "1.0.0"

spec:
  source:
    monorepo: "indestructibleautoops"
    path: "seccompops-platform/"

  target:
    repository: "https://github.com/indestructibleorg/indestructibleeco"
    path: "platforms/seccompops-platform"
    branch: "main"

  extraction_steps:
    - step: 1
      action: "Copy platform directory"
      command: "cp -r seccompops-platform/ <target>/platforms/seccompops-platform/"

    - step: 2
      action: "Verify no cross-platform imports"
      command: "grep -r 'from superai' src/ || grep -r 'from govops' src/ || echo 'CLEAN: No cross-platform dependencies'"

    - step: 3
      action: "Initialize standalone git"
      command: "cd <target>/platforms/seccompops-platform && git init"

    - step: 4
      action: "Install dependencies"
      command: "pip install -e '.[dev]'"

    - step: 5
      action: "Run tests"
      command: "pytest tests/"

    - step: 6
      action: "Build container"
      command: "docker build -f Dockerfile.prod -t seccompops-platform:latest ."

  verification:
    - "All tests pass independently"
    - "Docker image builds successfully"
    - "No references to sibling platforms"
    - "All registries validate with 100% score"
    - "API endpoints respond correctly"

  rollback:
    strategy: "Delete extracted directory, re-extract from monorepo"
